<%!
from datetime import timedelta
%>

<table class="main" style="width:1000px;">
 <tbody>
  <tr>
   <td>
    ###<button class="HappyButton" type="button">
     <img alt="" src="${module.getStatusIcon()}" />
    ###</button>
   </td>
   <td>
    <strong>
     <a id="${module.instance_name}" style='position:relative; top:-162px'></a>
     <a href="${module.url()}" style="text-decoration:none;color:#000000;" onfocus="this.blur()">${module.config["name"]}</a>
     <br />
     <span style="color:#999; font: bold 0.7em sans-serif;">${run["time"].strftime("%d. %b %Y, %H:%M")}</span>
     <span style="color:gray;">-</span>
     <small>
      <a href="" class="HappyLink" id="${module.instance_name}_info_link">Show module information</a>
     </small>
    </strong>
   </td>   
  </tr>
  <tr>
   <td> </td>
   <td>
    <div style="display:none;" class='HappyDesc' id="${module.instance_name}_info_box">
     <ul>
      <li><span class="key">Module</span><span class="value">${module.module_name}</span></li>
      <li><span class="key">Instance</span><span class="value">${module.instance_name}</span></li>
      <li><span class="key">Type</span><span class="value">${module.type}</span></li>
      <li><span class="key">Weight</span><span class="value">${module.weight}</span></li>
% if not no_data:
      <li><span class="key">Status</span><span class="value">${module.dataset["status"]}</span></li>
      <li><span class="key">Description</span><span class="value">${module.dataset["description"]}</span></li>
      <li><span class="key">Instruction</span><span class="value">${module.dataset["instruction"]}</span></li>
%endif
% if not no_data:
      <li><span class="key">Data source</span><span class="value"><a href="${dataset["source_url"]}">${module.dataset["source_url"]}</a></span></li>
% endif
     </ul>
     <form class="PlotMask" action="${hf.plotgenerator.getTimeseriesUrl()}" method="get" target="_blank">
      <label><span>Start</span><input type="text" name="start_date" value="${(run["time"]-timedelta(2)).strftime("%Y-%m-%d")}" class="DateField" />
      <input type="text" name="start_time" value="${(run["time"]-timedelta(2)).strftime("%H:%M")}" class="TimeField" /></label>
      <label><span>End</span><input type="text" name="end_date" value="${run["time"].strftime("%Y-%m-%d")}" class="DateField" />
      <input type="text" name="end_time" value="${run["time"].strftime("%H:%M")}" class="TimeField" /></label>
      <input type="hidden" name="title" value="${module.instance_name}" />
      <input type="hidden" name="legend" value="1" />
      <label><span>Variable</span><select name="curve_1">
% for var in module.getPlotableColumns():
       <option value="${module.instance_name},,${var},${var}">${var}</option>
% endfor
      </select></label>
      <input name="submit" type="submit" value="Plot" />
     </form>
    </div>
% if no_data:
    <p>No data at this time.</p>
% else:
 % if len(module.dataset["error_string"]) > 0:
    <p style="color:red;">${module.dataset["error_string"]}</p>
 % else:
${self.content()}
 % endif
% endif
   </td>
  </tr>
 </tbody>
</table>
